---
title: "КР1 // NHST"
subtitle: "Современные методы анализа данных // РАНХиГС"
format: html
editor: source
theme: materia
---

## Часть 1

### 1

Загрузите данные о 


### 2



### 3



### 4



## Часть 2

Теперь поработает с [экспериментальными данными]().

### Описание данных

В эксперименте испытуемым необходимо было искать целевые иконки среди дистракторов. Целевая иконка задавалась предъявлением изображения иконки перед экспериментальной пробой. Фиксиловались время реакции (`time`) и отчет испытуемого о нахождении целеовго стимула (`key`). Если испытуемый нашел целевую иконку в предъявленом наборе, он нажимал стрелку вправо (`right`), если не нашел --- влево (`left`). Варьировались следующие параметры: количество стимулов в пробе --- `3`, `6`, `9`, тип иконки --- плоская (`flat`) и с градиентом (`gradient`) и наличие тени у иконки (`shadow`). В эксперименте были обычные пробы, где присутствовал целевой стимул (`present`) и пробы-ловушки, в которых целевой стимул отсутствовал (`absent`).


### 5

**Загрузите данные поведенческого эксперимента на зрительный поиск. Проверьте их структуру. Отберите только корректные пробы.** 

Корректными считаются пробы, в которых был целевой стимул (`present`) и испытуемый отчитался о нахождении целевого стимула (`right`), и пробы, в которых целевого стимула не было (`absent`) и испытуемый отчитался о его отсутствии (`left`).


```{r, include=FALSE}
library(tidyverse)

fs <- read_csv("data/design_fastsearch.csv")
str(fs)
fs |> 
    mutate(type = ifelse(str_detect(cond, "^f"), "flat", "gradient"),
           shadow = ifelse(str_detect(cond, "s"), TRUE, FALSE),
           setsize = str_extract(cond, "\\d"),
           stimulus = ifelse(str_detect(cond, "p$"), "present", "absent"),
           key = str_remove_all(key, "'")) |> 
    select(-cond) |> 
    rename("trial" = `...1`) |> 
    write_csv("data/fastsearch.csv")
```

```{r, include=FALSE}
library(tidyverse)
theme_set(theme_bw())

fs <- read_csv("data/fastsearch.csv")
str(fs)
fs |> filter(stimulus == "present" & key == "right" | stimulus == "absent" & key == "left") -> fs_correct
```

### 6

**Удалите из данных выбросы.**

Считайте выбросами те пробы, в которых время реакции (`time`) отклоняется от среднего значения (среднего арифметического), более чем на 2.5 стандартных отклонения. Учтите при определении выброса группировку данных по экспериментальным условиям --- количеству стимулов в пробе, типу стимула и наличию тени, а также по идентификатору испытуемого (`id`).

<details>
<summary>Может пригодиться код</summary>
```
is_outlier <- function(x) {!(x < mean(x) + 2.5 * sd(x) & x > mean(x) - 2.5 * sd(x))}
```
</details>

```{r, include=FALSE}
is_outlier <- function(x) {!(x < mean(x) + 2.5 * sd(x) & x > mean(x) - 2.5 * sd(x))}
fs_correct |> 
    group_by(type, shadow, setsize, id) |> 
    mutate(is_outlier = is_outlier(time)) |> 
    filter(!is_outlier) -> fs_clean
```


### 7

**Протестируйте гипотезу о том, что фактор тени ускоряет скорость поиска целевой иконки.** 

Учтите, что данные не аггрегированы и каждое наблюдение --- это отдельная экспериментальная проба.

**Дайте статистическую интерпретацию полученных результатов: значимы ли различия? что можно сказать о размере эффекта?**

```{r, include=FALSE}
fs_clean |> 
    ungroup() |> 
    group_by(id, shadow) |> 
    summarise(rt = mean(time)) -> fs_agg
t.test(fs_agg$rt ~ fs_agg$shadow)
#t.test(fs_clean$time ~ fs_clean$shadow)
```

<details>
<summary>А?</summary>
```
?t.test
```
[Stepik](https://stepik.org/lesson/11504/step/1?unit=2527)
</details>

### 8

**Визуализируйте полученные результаты.**

```{r, include=FALSE}
fs_agg |> 
    ggplot(aes(shadow, rt)) +
    stat_summary(fun.data = mean_cl_boot, geom = "pointrange")
```
